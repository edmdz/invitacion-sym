---
interface Props {
  phoneNumber: string;
}
const { phoneNumber } = Astro.props;
---

<section class="rsvp-section">
  <div class="container">
    <h2>CONFIRMA TU ASISTENCIA</h2>
    <form id="rsvp-form">
      <div class="form-group">
        <label for="nombre">Nombre completo</label>
        <input type="text" id="nombre" name="nombre" placeholder="Escribe tu nombre aqu√≠..." required />
      </div>
      
      <!-- NUEVO: Grupo para la pregunta de asistencia -->
      <div class="form-group">
        <fieldset class="radio-group">
          <legend class="label">¬øPodr√°s acompa√±arnos?</legend>
          <div class="radio-options">
            <div class="radio-option">
              <input type="radio" id="asistencia-si" name="asistencia" value="S√≠" required />
              <label for="asistencia-si">S√≠</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="asistencia-no" name="asistencia" value="No" />
              <label for="asistencia-no">No</label>
            </div>
          </div>
        </fieldset>
      </div>

      <div class="form-group">
        <label for="mensaje">Un mensajito para los novios (opcional)</label>
        <textarea id="mensaje" name="mensaje" rows="4" placeholder="D√©janos unas palabras..."></textarea>
      </div>
      
      <button type="submit" class="whatsapp-button">Confirmar asistencia</button>
    </form>
  </div>
</section>

<script define:vars={{ phoneNumber }}>
  document.getElementById('rsvp-form').addEventListener('submit', function(event) {
    event.preventDefault();

    const nombre = document.getElementById('nombre').value;
    const mensaje = document.getElementById('mensaje').value;
    // CAMBIO: Capturamos la opci√≥n seleccionada (S√≠/No)
    const asistenciaChoice = document.querySelector('input[name="asistencia"]:checked');

    if (!nombre) {
      alert('Por favor, no olvides escribir tu nombre.');
      return;
    }
    // CAMBIO: Verificamos que se haya seleccionado una opci√≥n
    if (!asistenciaChoice) {
      alert('Por favor, selecciona si podr√°s acompa√±arnos.');
      return;
    }
    const asistenciaValor = asistenciaChoice.value;

    // CAMBIO: Creamos mensajes diferentes seg√∫n la respuesta
    let textoWhatsapp;
    if (asistenciaValor === 'S√≠') {
      textoWhatsapp = `¬°Hola! Soy ${nombre} y con mucha alegr√≠a confirmo mi asistencia a su boda. üéâ`;
    } else {
      textoWhatsapp = `Hola, soy ${nombre}. Con mucha pena les informo que no podr√© acompa√±arlos en su boda. üòî Les deseo toda la felicidad del mundo en su gran d√≠a.`;
    }

    if (mensaje) {
      textoWhatsapp += `\n\nAdem√°s, quer√≠a decirles que: "${mensaje}"`;
    }

    const url = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(textoWhatsapp)}`;
    window.open(url, '_blank');
  });
</script>

<style>
  .rsvp-section {
    background-color: var(--soft-white);
    padding: clamp(40px, 10vw, 80px) 20px;
    font-family: var(--font-sans);
  }
  .container {
    max-width: 550px;
    margin: 0 auto;
  }
  h2 {
    font-family: var(--font-serif);
    text-align: center;
    font-size: clamp(1.5rem, 5vw, 1.8rem);
    font-weight: 600;
    letter-spacing: 0.1em;
    margin: 0 0 40px;
    color: var(--gold);
    text-transform: uppercase;
  }
  .form-group {
    margin-bottom: 25px;
  }
  label, .label {
    display: block;
    margin-bottom: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--ink);
  }
  input[type="text"],
  textarea {
    width: 100%;
    padding: 14px;
    border: 1px solid var(--sand);
    border-radius: 8px;
    background-color: var(--white);
    font-family: var(--font-sans);
    font-size: 1rem;
    color: var(--ink);
    transition: border-color 0.3s, box-shadow 0.3s;
  }
  input[type="text"]:focus,
  textarea:focus {
    outline: none;
    border-color: var(--gold);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--gold) 20%, transparent);
  }
  textarea {
    resize: vertical;
    min-height: 100px;
  }

  /* --- NUEVO: Estilos para los botones de radio --- */
  .radio-group {
    border: none;
    padding: 0;
    margin: 0;
  }
  .radio-options {
    display: flex;
    gap: 30px; /* Espacio entre "S√≠" y "No" */
    margin-top: 10px;
  }
  .radio-option {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  input[type="radio"] {
    width: 1.2em;
    height: 1.2em;
    accent-color: var(--gold); /* Colorea el radio button con nuestro color principal */
  }
  .radio-option label {
    margin-bottom: 0; /* Reseteamos el margen del label dentro de esta opci√≥n */
    font-weight: normal;
  }
  /* ----------------------------------------------- */
  
  .whatsapp-button {
    display: block;
    width: 100%;
    padding: 15px 20px;
    margin-top: 30px;
    background-color: var(--gold);
    color: var(--white);
    font-family: var(--font-sans);
    font-weight: 600;
    font-size: 1rem;
    letter-spacing: 0.05em;
    text-align: center;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s;
  }
  .whatsapp-button:hover {
    background-color: color-mix(in srgb, var(--gold) 85%, black);
    transform: translateY(-2px);
  }
</style>